!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react-dom/client"),require("react")):"function"==typeof define&&define.amd?define(["exports","react-dom/client","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MyChatAgentSDK={},e.ReactDOM,e.React)}(this,function(e,t,r){"use strict";var n,o={exports:{}},a={};var s,i={};
/**
   * @license React
   * react-jsx-runtime.development.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */"production"===process.env.NODE_ENV?o.exports=function(){if(n)return a;n=1;var e=r,t=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,r,n){var o,a={},l=null,u=null;for(o in void 0!==n&&(l=""+n),void 0!==r.key&&(l=""+r.key),void 0!==r.ref&&(u=r.ref),r)s.call(r,o)&&!c.hasOwnProperty(o)&&(a[o]=r[o]);if(e&&e.defaultProps)for(o in r=e.defaultProps)void 0===a[o]&&(a[o]=r[o]);return{$$typeof:t,type:e,key:l,ref:u,props:a,_owner:i.current}}return a.Fragment=o,a.jsx=l,a.jsxs=l,a}():o.exports=(s||(s=1,"production"!==process.env.NODE_ENV&&function(){var e,t=r,n=Symbol.for("react.element"),o=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),y=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen"),h=Symbol.iterator,v=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function b(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];!function(e,t,r){var n=v.ReactDebugCurrentFrame.getStackAddendum();""!==n&&(t+="%s",r=r.concat([n]));var o=r.map(function(e){return String(e)});o.unshift("Warning: "+t),Function.prototype.apply.call(console[e],console,o)}("error",e,r)}function w(e){return e.displayName||"Context"}function j(e){if(null==e)return null;if("number"==typeof e.tag&&b("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),"function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case a:return"Fragment";case o:return"Portal";case c:return"Profiler";case s:return"StrictMode";case p:return"Suspense";case d:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case u:return w(e)+".Consumer";case l:return w(e._context)+".Provider";case f:return function(e,t,r){var n=e.displayName;if(n)return n;var o=t.displayName||t.name||"";return""!==o?r+"("+o+")":r}(e,e.render,"ForwardRef");case y:var t=e.displayName||null;return null!==t?t:j(e.type)||"Memo";case m:var r=e,n=r._payload,i=r._init;try{return j(i(n))}catch(e){return null}}return null}e=Symbol.for("react.module.reference");var k,_,x,S,E,O,R,C=Object.assign,N=0;function T(){}T.__reactDisabledLog=!0;var P,$=v.ReactCurrentDispatcher;function I(e,t,r){if(void 0===P)try{throw Error()}catch(e){var n=e.stack.trim().match(/\n( *(at )?)/);P=n&&n[1]||""}return"\n"+P+e}var D,A=!1,F="function"==typeof WeakMap?WeakMap:Map;function M(e,t){if(!e||A)return"";var r,n=D.get(e);if(void 0!==n)return n;A=!0;var o,a=Error.prepareStackTrace;Error.prepareStackTrace=void 0,o=$.current,$.current=null,function(){if(0===N){k=console.log,_=console.info,x=console.warn,S=console.error,E=console.group,O=console.groupCollapsed,R=console.groupEnd;var e={configurable:!0,enumerable:!0,value:T,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}N++}();try{if(t){var s=function(){throw Error()};if(Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(s,[])}catch(e){r=e}Reflect.construct(e,[],s)}else{try{s.call()}catch(e){r=e}e.call(s.prototype)}}else{try{throw Error()}catch(e){r=e}e()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var i=t.stack.split("\n"),c=r.stack.split("\n"),l=i.length-1,u=c.length-1;l>=1&&u>=0&&i[l]!==c[u];)u--;for(;l>=1&&u>=0;l--,u--)if(i[l]!==c[u]){if(1!==l||1!==u)do{if(l--,--u<0||i[l]!==c[u]){var f="\n"+i[l].replace(" at new "," at ");return e.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",e.displayName)),"function"==typeof e&&D.set(e,f),f}}while(l>=1&&u>=0);break}}}finally{A=!1,$.current=o,function(){if(0===--N){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:C({},e,{value:k}),info:C({},e,{value:_}),warn:C({},e,{value:x}),error:C({},e,{value:S}),group:C({},e,{value:E}),groupCollapsed:C({},e,{value:O}),groupEnd:C({},e,{value:R})})}N<0&&b("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}(),Error.prepareStackTrace=a}var p=e?e.displayName||e.name:"",d=p?I(p):"";return"function"==typeof e&&D.set(e,d),d}function L(e,t,r){if(null==e)return"";if("function"==typeof e)return M(e,!(!(n=e.prototype)||!n.isReactComponent));var n;if("string"==typeof e)return I(e);switch(e){case p:return I("Suspense");case d:return I("SuspenseList")}if("object"==typeof e)switch(e.$$typeof){case f:return M(e.render,!1);case y:return L(e.type,t,r);case m:var o=e,a=o._payload,s=o._init;try{return L(s(a),t,r)}catch(e){}}return""}D=new F;var U=Object.prototype.hasOwnProperty,W={},z=v.ReactDebugCurrentFrame;function K(e){if(e){var t=e._owner,r=L(e.type,e._source,t?t.type:null);z.setExtraStackFrame(r)}else z.setExtraStackFrame(null)}var B=Array.isArray;function V(e){return B(e)}function Y(e){return""+e}function q(e){if(function(e){try{return Y(e),!1}catch(e){return!0}}(e))return b("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",function(e){return"function"==typeof Symbol&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object"}(e)),Y(e)}var H,J,X=v.ReactCurrentOwner,G={key:!0,ref:!0,__self:!0,__source:!0};function Q(e,t,r,o,a){var s,i={},c=null,l=null;for(s in void 0!==r&&(q(r),c=""+r),function(e){if(U.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return!1}return void 0!==e.key}(t)&&(q(t.key),c=""+t.key),function(e){if(U.call(e,"ref")){var t=Object.getOwnPropertyDescriptor(e,"ref").get;if(t&&t.isReactWarning)return!1}return void 0!==e.ref}(t)&&(l=t.ref,function(e){"string"==typeof e.ref&&X.current}(t)),t)U.call(t,s)&&!G.hasOwnProperty(s)&&(i[s]=t[s]);if(e&&e.defaultProps){var u=e.defaultProps;for(s in u)void 0===i[s]&&(i[s]=u[s])}if(c||l){var f="function"==typeof e?e.displayName||e.name||"Unknown":e;c&&function(e,t){var r=function(){H||(H=!0,b("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",t))};r.isReactWarning=!0,Object.defineProperty(e,"key",{get:r,configurable:!0})}(i,f),l&&function(e,t){var r=function(){J||(J=!0,b("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",t))};r.isReactWarning=!0,Object.defineProperty(e,"ref",{get:r,configurable:!0})}(i,f)}return function(e,t,r,o,a,s,i){var c={$$typeof:n,type:e,key:t,ref:r,props:i,_owner:s,_store:{}};return Object.defineProperty(c._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(c,"_self",{configurable:!1,enumerable:!1,writable:!1,value:o}),Object.defineProperty(c,"_source",{configurable:!1,enumerable:!1,writable:!1,value:a}),Object.freeze&&(Object.freeze(c.props),Object.freeze(c)),c}(e,c,l,a,o,X.current,i)}var Z,ee=v.ReactCurrentOwner,te=v.ReactDebugCurrentFrame;function re(e){if(e){var t=e._owner,r=L(e.type,e._source,t?t.type:null);te.setExtraStackFrame(r)}else te.setExtraStackFrame(null)}function ne(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}function oe(){if(ee.current){var e=j(ee.current.type);if(e)return"\n\nCheck the render method of `"+e+"`."}return""}Z=!1;var ae={};function se(e,t){if(e._store&&!e._store.validated&&null==e.key){e._store.validated=!0;var r=function(e){var t=oe();if(!t){var r="string"==typeof e?e:e.displayName||e.name;r&&(t="\n\nCheck the top-level render call using <"+r+">.")}return t}(t);if(!ae[r]){ae[r]=!0;var n="";e&&e._owner&&e._owner!==ee.current&&(n=" It was passed a child from "+j(e._owner.type)+"."),re(e),b('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',r,n),re(null)}}}function ie(e,t){if("object"==typeof e)if(V(e))for(var r=0;r<e.length;r++){var n=e[r];ne(n)&&se(n,t)}else if(ne(e))e._store&&(e._store.validated=!0);else if(e){var o=function(e){if(null===e||"object"!=typeof e)return null;var t=h&&e[h]||e["@@iterator"];return"function"==typeof t?t:null}(e);if("function"==typeof o&&o!==e.entries)for(var a,s=o.call(e);!(a=s.next()).done;)ne(a.value)&&se(a.value,t)}}function ce(e){var t,r=e.type;if(null!=r&&"string"!=typeof r){if("function"==typeof r)t=r.propTypes;else{if("object"!=typeof r||r.$$typeof!==f&&r.$$typeof!==y)return;t=r.propTypes}if(t){var n=j(r);!function(e,t,r,n,o){var a=Function.call.bind(U);for(var s in e)if(a(e,s)){var i=void 0;try{if("function"!=typeof e[s]){var c=Error((n||"React class")+": "+r+" type `"+s+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[s]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw c.name="Invariant Violation",c}i=e[s](t,s,n,r,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(e){i=e}!i||i instanceof Error||(K(o),b("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",n||"React class",r,s,typeof i),K(null)),i instanceof Error&&!(i.message in W)&&(W[i.message]=!0,K(o),b("Failed %s type: %s",r,i.message),K(null))}}(t,e.props,"prop",n,e)}else void 0===r.PropTypes||Z||(Z=!0,b("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",j(r)||"Unknown"));"function"!=typeof r.getDefaultProps||r.getDefaultProps.isReactClassApproved||b("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}var le={};function ue(t,r,o,i,h,v){var w=function(t){return"string"==typeof t||"function"==typeof t||t===a||t===c||t===s||t===p||t===d||t===g||"object"==typeof t&&null!==t&&(t.$$typeof===m||t.$$typeof===y||t.$$typeof===l||t.$$typeof===u||t.$$typeof===f||t.$$typeof===e||void 0!==t.getModuleId)}(t);if(!w){var k,_="";(void 0===t||"object"==typeof t&&null!==t&&0===Object.keys(t).length)&&(_+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),_+=oe(),null===t?k="null":V(t)?k="array":void 0!==t&&t.$$typeof===n?(k="<"+(j(t.type)||"Unknown")+" />",_=" Did you accidentally export a JSX literal instead of a component?"):k=typeof t,b("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",k,_)}var x=Q(t,r,o,h,v);if(null==x)return x;if(w){var S=r.children;if(void 0!==S)if(i)if(V(S)){for(var E=0;E<S.length;E++)ie(S[E],t);Object.freeze&&Object.freeze(S)}else b("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else ie(S,t)}if(U.call(r,"key")){var O=j(t),R=Object.keys(r).filter(function(e){return"key"!==e}),C=R.length>0?"{key: someKey, "+R.join(": ..., ")+": ...}":"{key: someKey}";le[O+C]||(b('A props object containing a "key" prop is being spread into JSX:\n  let props = %s;\n  <%s {...props} />\nReact keys must be passed directly to JSX without using spread:\n  let props = %s;\n  <%s key={someKey} {...props} />',C,O,R.length>0?"{"+R.join(": ..., ")+": ...}":"{}",O),le[O+C]=!0)}return t===a?function(e){for(var t=Object.keys(e.props),r=0;r<t.length;r++){var n=t[r];if("children"!==n&&"key"!==n){re(e),b("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",n),re(null);break}}null!==e.ref&&(re(e),b("Invalid attribute `ref` supplied to `React.Fragment`."),re(null))}(x):ce(x),x}var fe=function(e,t,r){return ue(e,t,r,!1)},pe=function(e,t,r){return ue(e,t,r,!0)};i.Fragment=a,i.jsx=fe,i.jsxs=pe}()),i);var c=o.exports;const l=({apiUrl:e,agentId:t,apiKey:n,initialMessages:o})=>{const[a,s]=r.useState(o||[]),[i,c]=r.useState(""),[l,u]=r.useState(!1),[f,p]=r.useState(null);r.useEffect(()=>{o&&0===a.length&&s(o)},[o,a]);const d=r.useCallback(async(r,o)=>{r&&r.preventDefault();const a=o||i;if(!a.trim()||l)return;const f={role:"user",content:a};s(e=>[...e,f]),c(""),u(!0),p(null);try{const r=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",...n?{Authorization:`Bearer ${n}`}:{}},body:JSON.stringify({query:a,agentId:t})});if(!r.ok){const e=await r.json().catch(()=>({}));throw new Error(e.error||"An API error occurred.")}const o={role:"assistant",content:(await r.json()).answer||"Sorry, I could not get a response."};s(e=>[...e,o])}catch(e){const t=e instanceof Error?e.message:"An unknown error occurred.";p(t),s(e=>[...e,{role:"assistant",content:`Error: ${t}`}])}finally{u(!1)}},[e,t,n,i,l]);return{messages:a,input:i,isLoading:l,error:f,setInput:c,sendMessage:d,setMessages:s}};function u({message:e,themeColor:t}){const r="user"===e.role?"User":"Agent",n="user"===e.role;return c.jsxs("div",{className:`message-wrapper ${e.role}`,children:[c.jsx("div",{className:"message-header",children:r}),c.jsx("div",{className:`message-bubble ${e.role}`,style:{backgroundColor:n?t:void 0},children:c.jsx("p",{dangerouslySetInnerHTML:{__html:e.content.replace(/\n/g,"<br />")}})})]})}const f=({apiUrl:e,agentId:t,apiKey:n,welcomeMessage:o="Hello! How can I help you today?",placeholderText:a="Type your message...",themeColor:s="#029690"})=>{const[i,f]=r.useState(!1),{messages:p,input:d,isLoading:y,error:m,setInput:g,sendMessage:h,setMessages:v}=l({apiUrl:e,agentId:t,apiKey:n,initialMessages:[{role:"assistant",content:o}]}),b=r.useRef(null);return r.useEffect(()=>{i&&b.current?.scrollIntoView({behavior:"smooth"})},[p,y,i]),r.useEffect(()=>{i||v([{role:"assistant",content:o}])},[i,o,v]),c.jsxs("div",{className:"chat-widget-container",children:[i&&c.jsxs("div",{className:"chat-widget-root",children:[c.jsxs("header",{className:"chat-header",style:{backgroundColor:s},children:[c.jsx("h2",{children:"Agent"}),c.jsx("button",{onClick:()=>f(!1),className:"close-button",children:"×"})]}),c.jsx("main",{className:"chat-body",children:c.jsxs("div",{className:"message-list",children:[p.map((e,t)=>c.jsx(u,{message:e,themeColor:s},t)),y&&c.jsx("div",{className:"message-wrapper assistant",children:c.jsxs("div",{className:"message-bubble assistant loading-bubble",children:[c.jsx("div",{className:"loading-dot"}),c.jsx("div",{className:"loading-dot",style:{animationDelay:"0.1s"}}),c.jsx("div",{className:"loading-dot",style:{animationDelay:"0.2s"}})]})}),m&&c.jsx("div",{className:"error-message",children:m}),c.jsx("div",{ref:b})]})}),c.jsx("footer",{className:"chat-footer",children:c.jsxs("form",{onSubmit:h,className:"chat-form",children:[c.jsx("input",{type:"text",value:d,onChange:e=>g(e.target.value),placeholder:a,className:"chat-input",disabled:y}),c.jsx("button",{type:"submit",disabled:y||!d.trim(),className:"send-button",style:{backgroundColor:s},children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]})})]}),c.jsx("button",{onClick:()=>f(!0),className:"chat-fab",style:{backgroundColor:s},children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 011.037-.443 48.282 48.282 0 005.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z"})})})]})};class p extends HTMLElement{connectedCallback(){this.attachShadow({mode:"open"}),this.root=t.createRoot(this.shadowRoot),this.render()}static get observedAttributes(){return["api-url","agent-id","api-key","agent-name","welcome-message","placeholder-text","theme-color"]}attributeChangedCallback(){this.render()}render(){if(!this.root||!this.shadowRoot)return;const e={apiUrl:this.getAttribute("api-url"),agentId:this.getAttribute("agent-id"),apiKey:this.getAttribute("api-key")||void 0,agentName:this.getAttribute("agent-name")||void 0,welcomeMessage:this.getAttribute("welcome-message")||void 0,placeholderText:this.getAttribute("placeholder-text")||void 0,themeColor:this.getAttribute("theme-color")||void 0};document.createElement("style"),this.root.render(r.createElement(f,e))}}customElements.define("chat-widget",p),e.ChatWidget=f,e.renderWidget=function(e,n){const o=document.getElementById(e);if(o){t.createRoot(o).render(r.createElement(f,n))}else console.error(`[ChatSDK] Element with ID "${e}" not found.`)},e.useChatAgent=l});
//# sourceMappingURL=chat-sdk.umd.js.map
